{% load static i18n l10n %}
{% if creatediv %}<div id="{{ name }}" class="leaflet-container-default"></div>{% endif %}
<script type="text/javascript">
    window.addEventListener("load", function loadmap() {
        var djoptions = {% autoescape off %}{{ djoptions }}{% endautoescape %},
            map = L.Map.djangoMap('{{ name }}', {djoptions: djoptions});

        if(typeof {{ callback }} == 'function') {
            console.warn('DEPRECATED: Use function callback is deprecated, prefer events (see documentation).');
            {{ callback }}(map, djoptions.bounds);
        }

        // Trigger init event
        var evt = new CustomEvent('map:init', {'map': map});
        window.dispatchEvent(event);
        // Register document maps, like window.forms :)
        window.maps = (window.maps || []).push(map);
    }, false);
</script>
